# An Interpretable Short-term Rainfall Forecasting Method Based On Attention Mechanism
#### 简介

针对现有气象业务中短临降雨预报不精确的问题，提出了一种基于注意力机制的短临降雨预报方法。计算标准化降水指数后对因子作归一化处理；使用随机森林算法筛选出与降雨密切相关的气象因子；设计带有注意力机制的长短期记忆网络模型，有效解决了长时间降雨序列信息丢失的问题，强化对关键信息的提取能力；对注意力权重可视化，提高模型透明度。在全国92个站点的实验结果验证了该方法有较好的泛化能力，在预测短临强降雨情况下比现有方法准确率更高。

#### 模型介绍

首先计算目标站点的标准化降水指数，利用随机森林算法计算出气象因子与降雨的相关程度，根据重要性动态筛选出与降雨密切相关的因子作为带有多头注意力的长短期记忆网络SRF的输入，预测目标未来3小时内的降雨量。模型建立主要分为三个部分：数据预处理与SPI计算，因子筛选与网络建模、权值可视化与模式对比。

![SRF.png](https://github.com/HHUsimba/Image-Storage/blob/master/SRF.png?raw=true)

#### 模型可视化

输入因子权重在网络中的动态变化解释了模型的迭代学习能力，实验使用热力图对网络中因子的参数变化进行可视化实现。如图6所示，（a）至（f）为连续六个时刻的因子权重变化图，横坐标![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image002.gif)为输入模型的因子，纵坐标*t,…,t-9*为历史时刻。色块颜色深浅表示因子权重大小。因子对于降雨影响程度越大，则色块颜色越深。白色代表权重影响最小，黑色代表权重影响最大。

![SRFvisualization.png](https://github.com/HHUsimba/Image-Storage/blob/master/SRFvisualization.png?raw=true)

#### 结果对比

| 模型  | MAE  | MSE  | TS   | Acc  |
| ----- | ---- | ---- | ---- | ---- |
| ARIMA | 2.53 | 6.87 | 0.74 | 0.68 |
| SVM   | 2.71 | 5.35 | 0.76 | 0.53 |
| MLP   | 2.46 | 7.32 | 0.72 | 0.55 |
| LSTM  | 1.89 | 4.74 | 0.81 | 0.67 |
| ECMWF | 3.62 | 9.03 | 0.79 | 0.69 |
| JAPAN | 3.94 | 9.82 | 0.77 | 0.62 |
| SRF   | 1.71 | 4.08 | 0.86 | 0.78 |